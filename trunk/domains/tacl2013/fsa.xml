<?xml version="1.0" encoding="UTF-8"?>
<fsa trigger="a_u" actionvar="a_m" initstate="start">

	<states>
		<state id="start" />
		<state id="do" action="Do({a_u})" />
		<state id="do2" action="Do({action})" />
		<state id="excuse-carry" action="Excuse(AlreadyCarryObject)" />
		<state id="excuse-donotsee" action="Excuse(DoNotSeeObject)" />
		<state id="excuse-donotcarry" action="Excuse(DoNotCarryObject)" />
		<state id="repeat" action="AskRepeat" />
		<state id="confirm" action="Confirm" />
		<state id="disconfirm" action="Disconfirm" />
		<state id="describe" action="Describe({perceived})" />
		<state id="stop" action="Do(Stop)" />
		<state id="wait-confirm" action="Confirm({a_u})" />
	</states>

	<edges>
		<edge source="start" target="do" condition="move" threshold="0.4" />
		<edge source="start" target="do" condition="pickup" threshold="0.4" />
		<edge source="start" target="do" condition="pickup-feet" threshold="0.4" />
		<edge source="start" target="excuse-carry" condition="carry" threshold="0.4" />
		<edge source="start" target="excuse-donotsee" condition="donotsee" threshold="0.4" />
		<edge source="start" target="do" condition="release" threshold="0.4" />
		<edge source="start" target="excuse-donotcarry" condition="notcarry" threshold="0.4" />
		<edge source="start" target="confirm" condition="doyousee-pos" threshold="0.4" />
		<edge source="start" target="disconfirm" condition="doyousee-neg" threshold="0.4" />
		<edge source="start" target="describe" condition="whatdoyousee" threshold="0.4" />
		<edge source="start" target="stop" condition="stop" threshold="0.4" />
		<edge source="start" target="repeat" condition="notunderstood" priority="2" threshold="0.4" />
		<edge source="start" target="wait-confirm" condition="notunderstood2" priority="2" threshold="0.3"/>
		<edge source="wait-confirm" target="do2" condition="move-confirm" threshold="0.4"/>
		<edge source="wait-confirm" target="do2" condition="pickup-confirm" threshold="0.4" />
		<edge source="wait-confirm" target="do2" condition="pickup-feet-confirm" threshold="0.4" />
		<edge source="wait-confirm" target="excuse-carry" condition="carry-confirm" threshold="0.4" />
		<edge source="wait-confirm" target="excuse-donotsee" condition="donotsee-confirm" threshold="0.4" />
		<edge source="wait-confirm" target="do2" condition="release-confirm" threshold="0.4" />
		<edge source="wait-confirm" target="excuse-donotcarry" condition="notcarry-confirm" threshold="0.4" />
		<edge source="wait-confirm" target="start" condition="notunderstood" priority="2" threshold="0.4" />
		<edge source="do" target="start" />
		<edge source="do2" target="start" />
		<edge source="excuse-carry" target="start" />
		<edge source="excuse-donotsee" target="start" />
		<edge source="excuse-donotcarry" target="start" />
		<edge source="repeat" target="start" />
		<edge source="confirm" target="start" />
		<edge source="disconfirm" target="start" />
		<edge source="describe" target="start" />
		<edge source="stop" target="start" />
	</edges>

	<conditions>

		<condition id="move">
			<if var="a_u" value="Move(*)" />
		</condition>

		<condition id="pickup" operator="and">
			<if var="a_u" value="PickUp({X})" />
			<if var="perceived" value="{X}" relation="contains" />
			<if var="carried" value="[]" />
		</condition>

		<condition id="pickup-feet" operator="and">
			<if var="a_u" value="PickUp(AtFeet)" />
			<if var="carried" value="[]" />
		</condition>

		<condition id="carry" operator="and">
			<if var="a_u" value="PickUp({X})" />
			<if var="perceived" value="{X}" relation="contains" />
			<if var="carried" value="[]" relation="!=" />
		</condition>

		<condition id="donotsee">
			<if var="a_u" value="PickUp({X})" />
			<if var="perceived" value="{X}" relation="notcontains" />
		</condition>

		<condition id="release" operator="and">
			<if var="a_u" value="Release" />
			<if var="carried" value="None" relation="!=" />
			<if var="carried" value="[]" relation="!=" />
		</condition>

		<condition id="notcarry">
			<if var="a_u" value="Release" />
			<if var="carried" value="{X}" relation="notcontains" />
		</condition>

		<condition id="notunderstood">
			<if var="a_u" value="None" relation="!=" />
			<if var="a_u" value="Nothing" relation="!=" />
		</condition>
		
		
		<condition id="notunderstood2">
			<if var="a_u" value="None" relation="!=" />
			<if var="a_u" value="Nothing" relation="!=" />
			<if var="a_u" value="DoYouSee(*)" relation="!=" />
			<if var="a_u" value="WhatDoYouSee" relation="!=" />
		</condition>


		<condition id="move-confirm">
			<if var="a_m" value="Confirm(Move(*))"/>
			<if var="a_m" value="Confirm({action})"/>
			<if var="a_u" value="Confirm" />
		</condition>

		<condition id="pickup-confirm" operator="and">
			<if var="a_m" value="Confirm(PickUp({X}))" />
			<if var="a_m" value="Confirm({action})"/>
			<if var="a_u" value="Confirm"/>
			<if var="perceived" value="{X}" relation="contains" />
			<if var="carried" value="[]" />
		</condition>

		<condition id="pickup-feet-confirm" operator="and">
			<if var="a_m" value="Confirm(PickUp(AtFeet))" />
			<if var="a_m" value="Confirm({action})"/>
			<if var="a_u" value="Confirm"/>
			<if var="carried" value="[]" />
		</condition>

		<condition id="carry-confirm" operator="and">
			<if var="a_m" value="Confirm(PickUp({X}))" />
			<if var="a_m" value="Confirm({action})"/>
			<if var="a_u" value="Confirm"/>
			<if var="perceived" value="{X}" relation="contains" />
			<if var="carried" value="[]" relation="!=" />
		</condition>

		<condition id="donotsee-confirm">
			<if var="a_m" value="Confirm(PickUp({X}))" />
			<if var="a_m" value="Confirm({action})"/>
			<if var="a_u" value="Confirm"/>
			<if var="perceived" value="{X}" relation="notcontains" />
		</condition>

		<condition id="release-confirm" operator="and">
			<if var="a_m" value="Confirm(Release)" />
			<if var="a_m" value="Confirm({action})"/>
			<if var="a_u" value="Confirm"/>
			<if var="carried" value="None" relation="!=" />
			<if var="carried" value="[]" relation="!=" />
		</condition>

		<condition id="notcarry-confirm">
			<if var="a_m" value="Confirm(Release)" />
			<if var="a_m" value="Confirm({action})"/>
			<if var="a_u" value="Confirm"/>
			<if var="carried" value="{X}" relation="notcontains" />
		</condition>
		
		
		<condition id="doyousee-pos">
			<if var="a_u" value="DoYouSee({X})" />
			<if var="perceived" value="{X}" relation="contains" />
		</condition>

		<condition id="doyousee-neg">
			<if var="a_u" value="DoYouSee({X})" />
			<if var="perceived" value="{X}" relation="notcontains" />
		</condition>

		<condition id="whatdoyousee">
			<if var="a_u" value="WhatDoYouSee" />
		</condition>

		<condition id="stop">
			<if var="a_u" value="Stop" />
		</condition>

		<condition id="confirm">
			<if var="a_u" value="Confirm" />
		</condition>

		<condition id="disconfirm">
			<if var="a_u" value="Disconfirm" />
		</condition>

	</conditions>


</fsa>